$(function () { loadMenuTree(true) }); $(window).resize(function () { navresize() }); function loadMenuTree(a) { var b = false; if (arguments.length == 1 && a) { b = true } $.ajax({ type: "post", url: "tool/lefttree.aspx?time=" + Math.random(), dataType: "html", success: function (c, d) { $("#sidebar-nav .list-box").html(c); $("#pop-menu .list-box").html(c); initMenuTree(b); initPopMenuTree(); $("#sidebar-nav").niceScroll({ touchbehavior: false, cursorcolor: "#7C7C7C", cursoropacitymax: 0.6, cursorwidth: 5 }); $("#pop-menu .list-box").niceScroll({ touchbehavior: false, cursorcolor: "#7C7C7C", cursoropacitymax: 0.6, cursorwidth: 5 }); $("#pop-menu .list-box").getNiceScroll().hide(); navresize() } }) } function initMenuTree(a) { $("#nav").html(""); $("#sidebar-nav .list-box .list-group").each(function (c) { var b = $('<li><i class="icon-' + c + '"></i><span>' + $(this).attr("name") + "</span></li>").appendTo($("#nav")); if (c == 0) { $(this).show(); b.addClass("selected") } b.click(function () { $("#nav li").removeClass("selected"); $(this).addClass("selected"); $("#sidebar-nav .list-box .list-group").hide(); $("#sidebar-nav .list-box .list-group").eq($("#nav li").index($(this))).show() }); $(this).children("h2").click(function () { if ($(this).next("ul").css("display") != "none") { return false } $(this).siblings("ul").slideUp(300); $(this).next("ul").slideDown(300); if ($(this).next("ul").children("li").first().children("ul").length > 0) { } }); $(this).find("ul").hide(); $(this).find("ul").each(function (d) { $(this).children("li").each(function () { liObj = $(this); var h = liObj.children("a").children("span"); $('<div class="arrow"></div>').insertBefore(h); var f = liObj.parent().parent().children("a").children(".expandable").length; if (liObj.children("ul").length > 0) { liObj.children("a").removeAttr("href"); liObj.children("a").addClass("pack"); var e; for (var g = 0; g <= f; g++) { e = $('<div class="expandable"></div>').insertBefore(h) } e.addClass("close"); $('<div class="folder close"></div>').insertBefore(h); liObj.children("ul").hide(); liObj.children("a").click(function () { $(this).parent().siblings().each(function () { if ($(this).children("ul").length > 0) { $(this).children("a").children(".expandable").last().removeClass("open"); $(this).children("a").children(".expandable").last().addClass("close"); $(this).children("ul").slideUp(300) } }); $(this).children(".expandable").last().removeClass("close"); $(this).children(".expandable").last().addClass("open"); $(this).parent().children("ul").slideDown(300) }) } else { for (var g = 0; g < f; g++) { $('<div class="expandable"></div>').insertBefore(h) } $('<div class="folder open"></div>').insertBefore(h); liObj.children("a").click(function () { $("#sidebar-nav .list-box .list-group ul li a").removeClass("selected"); $(this).addClass("selected"); addCookie("hik_manage_navigation_cookie", $(this).attr("navid"), 240) }) } }); if (d == 0) { $(this).show(); if ($(this).children("li").first().children("ul").length > 0) { $(this).children("li").first().children("a").children(".expandable").last().removeClass("close"); $(this).children("li").first().children("a").children(".expandable").last().addClass("open"); $(this).children("li").first().children("ul").show() } } }) }); linkMenuTree(a) } function linkMenuTree(e, d) { var b; var c = arguments.length; if (c == 2) { b = $("#sidebar-nav").find('a[navid="' + d + '"]') } else { b = $("#sidebar-nav").find('a[navid="' + getCookie("hik_manage_navigation_cookie") + '"]') } if (b.length > 0) { var a = $("#sidebar-nav .list-box .list-group").index(b.parents(".list-group")); $("#nav li").removeClass("selected"); $("#nav li").eq(a).addClass("selected"); b.parents(".list-group").siblings().hide(); b.parents(".list-group").show(); b.parents("li").each(function () { $(this).siblings().each(function () { if ($(this).children("ul").length > 0) { $(this).children("a").children(".expandable").last().removeClass("open"); $(this).children("a").children(".expandable").last().addClass("close"); $(this).children("ul").hide() } }); if ($(this).children("ul").length > 0) { $(this).children("a").children(".expandable").last().removeClass("close"); $(this).children("a").children(".expandable").last().addClass("open") } $(this).children("ul").show() }); b.parents("ul").eq(-1).show(); b.parents("ul").eq(-1).siblings("ul").hide(); $("#sidebar-nav .list-box .list-group ul li a").removeClass("selected"); b.addClass("selected"); if (c == 2) { addCookie("hik_manage_navigation_cookie", d, 240) } if (e == true) { frames["mainframe"].location.href = b.attr("href") } } else { if (c == 2) { $("#sidebar-nav .list-box .list-group ul li a").removeClass("selected"); addCookie("hik_manage_navigation_cookie", "", 240) } } } function initPopMenuTree() {
    var a = $("#pop-menu .list-box .list-group").length * $("#pop-menu .list-box .list-group").outerWidth(); var b = $(window).height() * 0.6; if (a > ($(window).width() - 60)) { a = $(window).width() - 60 } var c = 0; $("#pop-menu .list-box .list-group").each(function () { if ($(this).height() > c) { c = $(this).height() } }); if (b > c) { b = c } $("#pop-menu .list-box .list-group").height(c); $("#pop-menu .pop-box").width(a); $("#pop-menu .pop-box").height(b); $("#pop-menu .pop-box .list-box li").each(function () {
        var d = $(this).children("a"); d.removeAttr("href");
        if ($(this).children("ul").length > 0) { d.addClass("nolink") } else { d.addClass("link"); d.click(function () { linkMenuTree(true, d.attr("navid")) }) }
    })
}
$(function () { if (getCookie("hik_manage_navigation_cookie") == "") { $("#mainframe").attr("src", "center.aspx"); } });
function triggerMenu(a) { if (a) { $("#pop-menu .list-box").getNiceScroll().show(); $("#pop-menu").css("visibility", "visible") } else { $("#pop-menu .list-box").getNiceScroll().hide(); $("#pop-menu").css("visibility", "hidden") } } function navresize() { var a = $(document).width(); if (a < 1004) { $(".nav li span").hide() } else { $(".nav li span").show() } };

//本地时钟
function clockon() { var now = new Date(); var year = now.getFullYear(); var month = now.getMonth(); var date = now.getDate(); var day = now.getDay(); var hour = now.getHours(); var minu = now.getMinutes(); var sec = now.getSeconds(); var week; month = month + 1; if (month < 10) month = "0" + month; if (date < 10) date = "0" + date; if (hour < 10) hour = "0" + hour; if (minu < 10) minu = "0" + minu; if (sec < 10) sec = "0" + sec; var arr_week = new Array("星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"); week = arr_week[day]; var time = ""; time = year + "年" + month + "月" + date + "日 " + hour + ":" + minu + ":" + sec + " " + week; $("#bgclock").html(time); var timer = setTimeout("clockon()", 200) }